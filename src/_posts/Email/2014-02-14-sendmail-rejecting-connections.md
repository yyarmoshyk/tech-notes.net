---
id: 493
title: Sendmail не принимает входящие соединения
date: 2014-02-14T14:19:45+00:00
author: admin

guid: http://www.tech-notes.net/?p=493
permalink: /sendmail-rejecting-connections/
image: /wp-content/uploads/2014/02/sendmail.gif
categories:
  - Почта
tags:
  - sendmail
---
<p>Нашел в логах вот такую ошибку и решил создать заметку на эту тему:</p>
```bash
sendmail[]: rejecting connections on daemon MTA: load average:
```
<p>Сервер всегда работает со значением `LoadAverage` больше `3`, что в принципе нормально для сервера под нагрузкой, при чем запас хода есть.<br />
Но вот ровно в полночь запускается `backup` и нагрузка резко возрастает. </p>
<p>Срабатывает заглушка `RefuseLA` в конфигурации `sendmail`. При достижении этого значения почта больше не принимается.<br />
Есть еще одна заглушка, которую хорошо было бы использовать - ``QueueLA``. Она определяет в какой момент почта начинает складываться в очередь на доставку (`MailQueue`).</p>
<p>Если вы заметили, что Ваш сервер в определенные моменты не доставляет почту, а в логах присутствуют ошибки, похожи на сообщение в начале поста, я рекомендую поставить конкретные значение `QueueLA` и `RefuseLA` в файлах:</p>
<ul>
<li><code>/etc/mail/sendmail.cf</code></li>
<li><code>/etc/mail/submit.cf</code></li>
</ul>
<p>Значения QueueLA и RefuseLA нужно устанавливать исходя из производительности Вашего сервера. Если не угадать - почта не будет отсылаться. </p>
<p>Нужно помониторить сервер некоторое время, что бы построить картину о том под какой нагрузкой он работает, потом менять настройки.</p>
<p>Больше информации можно найти <a href="http://www.sendmail.org/~ca/email/doc8.12/op-sh-4.html">здесь</a></p>
