---
id: 2695
title: Шпаргалка по Yum
date: 2015-07-17T13:59:52+00:00
author: admin

guid: http://www.tech-notes.net/?p=2695
permalink: /yum-notes/
image: /wp-content/uploads/2014/09/yum_logo.jpg
categories:
  - Linux server
tags:
  - CentOS
  - FromHabrSandbox
  - yum
---
Шпаргалка по работе с пакетным менеджером Yum (Yellowdog Updater, Modified), который используется в популярных Linux дистрибутивах: RedHat, CentOS, Scientific Linux (и других). В целях экономии места вывод команд не представлен.  
<!--more-->

## Оглавление

[Команды](#yumcommands)  
[Опции Yum](#options)  
[Пакет Yum-Utils](#yum-utils)  
[Конфигурационные файлы](#conf)  
[Плагины](#plugins)  
[Работа через прокси](#proxy)

<a name="yumcommands"></a>

отображение команд и опций

```bash
yum help
```

список названий пакетов из репозиторий

```bash
yum list
```

список всех доступных пакетов

```bash
yum list available
```

список всех установленных пакетов

```bash
yum list installed
```

установлен ли указанный пакет

```bash
yum list installed httpd
```

список установленных и доступных пакетов

```bash
yum list all
```

список пакетов, относящихся к ядру

```bash
yum list kernel
```

отображение информации о пакете

```bash
yum info httpd
```

список зависимостей и необходимых пакетов

```bash
yum deplist httpd
```

найти пакет, который содержит файл

```bash
yum provides '*bin/top'
```

поиск пакета по имени и описанию

```bash
yum search httpd
```

```bash
yum search yum
```

получить информацию о доступных обновлениях безопасности

```bash
yum updateinfo list security
```

вывести список групп

```bash
yum grouplist
```

вывести описание и содержимое группы

```bash
yum groupinfo 'Basic Web Server'
```

установка группы пакетов «Basic Web Server»

```bash
yum groupinstall 'Basic Web Server'
```

удаление группы

```bash
yum groupremove 'Basic Web Server'
```

Проверка на доступные обновления

```bash
yum check-update
```

список подключенных репозиториев

```bash
yum repolist
```

информация об определенном репозиторий

```bash
yum repoinfo epel
```

информация о пакетах в указанном репозитории

```bash
yum repo-pkgs epel list
```

установить все пакеты из репозитория

```bash
yum repo-pkgs reponame install
```

удалить пакеты установленные из репозитория

```bash
yum repo-pkgs reponame remove
```

создать кэш

```bash
yum makecache
```

проверить локальную базу rpm (поддерживаются параметры dependencies, duplicates, obsoletes, provides)

```bash
yum check
```

```bash
yum check dependencies
```

просмотр yum истории (вывод списка транзакций)

```bash
yum history list
```

просмотр информации определенной транзакции (установленные пакеты, установленные зависимости)

```bash
yum history info 9
```

отмена транзакции

```bash
yum history undo 9
```

повторить

```bash
yum history redo 9
```

дополнительно можно просмотреть лог

```bash
cat /var/log/yum.log
```

удалить пакеты сохраненные в кэше

```bash
yum clean packages
```

удалить все пакеты и метаданные

```bash
yum clean all
```

установить пакет

```bash
yum install httpd
```

удаление пакета

```bash
yum remove httpd
```

обновить пакет

```bash
yum update httpd
```

обновить все пакеты

```bash
yum update
```

обновить до определенной версии

```bash
yum update-to
```

обновить из локальной директории

```bash
yum localinstall httpd.rpm
```

установить с http

```bash
yum localinstall http://server/repo/httpd.rpm
```

откатиться к предыдущей версии пакета

```bash
yum downgrade
```

переустановка пакета (восстановление удаленных файлов)

```bash
yum reinstall httpd
```

удаление ненужных более пакетов

```bash
yum autoremove
```

создание локальных репозиториев (createrepo ставится отдельно)

```bash
createrepo
```

установка обновлений по расписанию (yum-cron устанавливается отдельно)

```bash
yum-cron
```

<center>
  <div id="gads">
  </div>
</center>


<a name="options"></a>

## Опции Yum

ответить «yes» при запросе,

`-y`

```bash
yum update -y
```

ответить «no» при запросе

`--assumeno`

использовать Yum без плагинов

`--noplugins`

или отключить определенный плагин

`--disableplugin=fastestmirror`

включить плагины, которые установлены, но отключены

```bash
yum -enableplugin=ps
```

включить отключенный репозиторий

```bash
yum update -y -enablerepo=epel
```

отключить репозиторий

```bash
yum update -y -disablerepo=epel
```

скачать пакеты, но не устанавливать

(на Centos 7 x86_64 будут скачаны в '/var/cache/yum/x86_64/7/base/packages/')

```bash
yum install httpd -downloadonly
```

<center>
  <div id="gads">
  </div>
</center>


<a name="yum-utils"></a>

## Cледующие команды доступны после установки пакета yum-utils

найти из какого репозитория установлен пакет

```bash
find-repos-of-install httpd
```

найти процессы, пакеты которых обновлены и требуют рестарта

```bash
need-restarting
```

запрос к репозиторию, узнать зависимости пакета, не устанавливая его

```bash
repoquery -requires -resolve httpd
```

синхронизировать yum репозиторий updates в локальную деректорию repo1

```bash
reposync -p repo1 -repoid=updates
```

проверить локальный репозиторий на целостность

```bash
verifytree URL
```

завершить транзакции

```bash
yum-complete-transaction
```

установить необходимые зависимости для сборки RPM пакета

```bash
yum-builddep
```

управление конфигурационными опциями и репозиториями yum

```bash
yum-config-manager
```

запрос к локальной базе yum, отображение информации о пакете

(использованная команда, контрольная сумма, URL с которого был установлен и другое)

```bash
yumdb info httpd
```

скачать rpm пакеты из репозитория

```bash
yumdownloader
```

скачать src.rpm пакет из репозитория

(должен быть подключен соответствующий репозиторий, например в '/etc/yum.repos.d/CentOS-Sources.repo' в CentOS)

`yumdownloader --source php`

<center>
  <div id="gads">
  </div>
</center>


<a name="conf"></a>

## Конфигурационные файлы Yum и их расположение

Основной конфигурационный файл

`/etc/yum.conf`

директория, с конфигурациями (например, yum плагины)

`/etc/yum/`

директория, содержащая информацию о репозиториях

`/etc/yum.conf.d/`

#### Некоторые опции yum.conf:

Директория, где yum хранит кэш и файлы базы (по умолчанию '/var/cache/yum')

```bash
cachedir=/var/cache/yum/$basearch/$releasever
```


Определяет должен или нет Yum хранить кэш заголовков и пакетов после успешной установки. Значения: 0 или 1. (по умолчанию 1)

`keepcache=1`

уровень вывода отладочных сообщений. Значения: 1-10 (по умолчанию 2)

`debuglevel=2`

лог файл (по умолчанию '/var/log/yum.log')

`logfile=/var/log/yum.log`

обновлять устаревшие пакеты

`obsoletes=1`

проверка подписи пакетов. Значения: 0 или 1 (по умолчанию 1)

`gpgcheck=1`

включение плагинов. Значения: 0 или 1 (по умолчанию 1)

`plugins=1`

<center>
  <div id="gads">
  </div>
</center>


<a name="plugins"></a>

## Некоторые полезные плагины

Добавляет опцию командной строки для просмотра ченжлога перед/после обновлениями

```bash
yum-plugin-changelog
```

выбирает более быстрые репозитории из списка зеркал

```bash
yum-plugin-fastestmirror
```

добавляет команды keys, keys-info, keys-data, keys-remove, которые позволяют работать с ключами.

```bash
yum-plugin-keys
```

блокировать указанные пакеты от обновления, команда yum versionlock

```bash
yum-plugin-versionlock
```

добаление команд yum verify-all, verify-multilib, verify-rpm для проверки контрольных сумм пакетов

```bash
yum-plugin-verify
```

<center>
  <div id="gads">
  </div>
</center>


<a name="proxy"></a>

## Работа Yum через прокси сервер

Для всех пользователей:

добавить в секцию [main] в /etc/yum.conf

```bash
proxy='http://server:3128'
```

при необходимости указать пароль, добавить
```bash
proxy_proxy_username=user
proxy_password=pass
```

указать прокси для отдельного пользователя
```bash
export http_proxy='http://server:3128'
```

Дополнительно читайте:
```bash
man yum
man rpm
```

<a href="http://habrahabr.ru/sandbox/95851/" target="_blank">Оригинал</a>
